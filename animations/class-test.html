<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Animation Manager - Fixed Test</title>
    <link rel="stylesheet" href="animations.css" />
    <style>
      body {
        font-family: system-ui, sans-serif;
        background: #f0f0f0;
        margin: 0;
        padding: 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 30px;
      }

      h1 {
        color: #333;
        margin: 0;
      }

      .demo-area {
        width: 600px;
        height: 300px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .box {
        width: 80px;
        height: 80px;
        background: #3498db;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        position: relative;
      }

      .controls {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
        max-width: 600px;
      }

      .btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 12px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: background 0.2s;
      }

      .btn:hover {
        background: #2980b9;
      }

      .btn:active {
        transform: translateY(1px);
      }

      .debug-controls {
        display: flex;
        gap: 12px;
        margin-top: 20px;
      }

      .debug-btn {
        background: #27ae60;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
      }

      .debug-btn:hover {
        background: #219a52;
      }

      @media (max-width: 768px) {
        .demo-area {
          width: 90vw;
          height: 250px;
        }

        .controls {
          grid-template-columns: repeat(2, 1fr);
          max-width: 90vw;
        }
      }
    </style>
  </head>
  <body>
    <h1>Animation Test - Fixed Version</h1>

    <div class="demo-area">
      <div class="box" id="test-box">BOX</div>
    </div>

    <div class="controls">
      <button class="btn" id="fade-in">Fade In</button>
      <button class="btn" id="fade-out">Fade Out</button>
      <button class="btn" id="slide-left">Slide Left</button>
      <button class="btn" id="slide-right">Slide Right</button>

      <button class="btn" id="bounce">Bounce</button>
      <button class="btn" id="pulse">Pulse</button>
      <button class="btn" id="shake">Shake</button>
      <button class="btn" id="spin">Spin</button>

      <button class="btn" id="grow">Grow</button>
      <button class="btn" id="shrink">Shrink</button>
      <button class="btn" id="color-change">Change Color</button>
      <button class="btn" id="reset">Reset</button>
    </div>

    <div class="debug-controls">
      <button class="debug-btn" id="show-debug">Show Debug Panel</button>
      <button class="debug-btn" id="show-inspector">Show Inspector</button>
      <button class="debug-btn" id="enable-logs">Enable Debug Logs</button>
    </div>

    <script src="animations.js"></script>
    <script src="animations-manager.js"></script>
    <script>
      // Initialize the animation system with debug capabilities
      const animationUI = new AnimationManagerUI(null, {
        enableDebugPanel: false, // Hidden by default
        enableInspector: false, // Hidden by default
        animationManager: null, // Let it create its own
      });

      // Get the animation manager from the UI system
      const animationManager = animationUI.animationManager;
      const box = document.getElementById("test-box");

      // Enable debug logs to see what's happening
      animationManager.options.enableDebugLogs = true;

      // Reset function
      function resetBox() {
        animationManager.stopAll();
        box.style.transform = "";
        box.style.opacity = "1";
        box.style.background = "#3498db";
        box.style.display = "flex";
        console.log("Box reset");
      }

      // Animation buttons with improved error handling
      document.getElementById("fade-in").addEventListener("click", () => {
        console.log("Fade in clicked");
        try {
          const animId = animationManager.fadeIn(box, { duration: 600 });
          console.log("Fade in animation ID:", animId);
        } catch (error) {
          console.error("Fade in error:", error);
        }
      });

      document.getElementById("fade-out").addEventListener("click", () => {
        console.log("Fade out clicked");
        try {
          const animId = animationManager.fadeOut(box, {
            duration: 600,
            hideAfter: false,
          });
          console.log("Fade out animation ID:", animId);
        } catch (error) {
          console.error("Fade out error:", error);
        }
      });

      document.getElementById("slide-left").addEventListener("click", () => {
        console.log("Slide left clicked");
        try {
          const animId = animationManager.createCssAnimation(
            box,
            {
              transform: "translateX(-200px)",
            },
            { duration: 800, easing: "ease-out" }
          );
          console.log("Slide left animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Slide left error:", error);
        }
      });

      document.getElementById("slide-right").addEventListener("click", () => {
        console.log("Slide right clicked");
        try {
          const animId = animationManager.createCssAnimation(
            box,
            {
              transform: "translateX(200px)",
            },
            { duration: 800, easing: "ease-out" }
          );
          console.log("Slide right animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Slide right error:", error);
        }
      });

      document.getElementById("bounce").addEventListener("click", () => {
        console.log("Bounce clicked");
        try {
          const result = animationManager.bounce(box, {
            height: 40,
            duration: 800,
          });
          console.log("Bounce result:", result);
        } catch (error) {
          console.error("Bounce error:", error);
        }
      });

      document.getElementById("pulse").addEventListener("click", () => {
        console.log("Pulse clicked");
        try {
          const result = animationManager.pulse(box, {
            scale: 1.3,
            duration: 600,
            iterations: 2,
          });
          console.log("Pulse result:", result);
        } catch (error) {
          console.error("Pulse error:", error);
        }
      });

      document.getElementById("shake").addEventListener("click", () => {
        console.log("Shake clicked");
        try {
          const result = animationManager.shake(box, {
            intensity: 15,
            duration: 500,
          });
          console.log("Shake result:", result);
        } catch (error) {
          console.error("Shake error:", error);
        }
      });

      document.getElementById("spin").addEventListener("click", () => {
        console.log("Spin clicked");
        try {
          const animId = animationManager.createCssAnimation(
            box,
            {
              transform: "rotate(360deg)",
            },
            { duration: 1000, easing: "ease-in-out" }
          );
          console.log("Spin animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Spin error:", error);
        }
      });

      document.getElementById("grow").addEventListener("click", () => {
        console.log("Grow clicked");
        try {
          const animId = animationManager.createCssAnimation(
            box,
            {
              transform: "scale(1.5)",
            },
            { duration: 500, easing: "ease-out" }
          );
          console.log("Grow animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Grow error:", error);
        }
      });

      document.getElementById("shrink").addEventListener("click", () => {
        console.log("Shrink clicked");
        try {
          const animId = animationManager.createCssAnimation(
            box,
            {
              transform: "scale(1)",
            },
            { duration: 500, easing: "ease-in" }
          );
          console.log("Shrink animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Shrink error:", error);
        }
      });

      document.getElementById("color-change").addEventListener("click", () => {
        console.log("Color change clicked");
        try {
          const colors = [
            "#e74c3c",
            "#27ae60",
            "#f39c12",
            "#9b59b6",
            "#3498db",
          ];
          const randomColor = colors[Math.floor(Math.random() * colors.length)];

          const animId = animationManager.createCssAnimation(
            box,
            {
              backgroundColor: randomColor,
            },
            { duration: 400, easing: "ease-in-out" }
          );
          console.log("Color change animation ID:", animId);
          const playResult = animationManager.play(animId);
          console.log("Play result:", playResult);
        } catch (error) {
          console.error("Color change error:", error);
        }
      });

      document.getElementById("reset").addEventListener("click", resetBox);

      // Debug controls
      document.getElementById("show-debug").addEventListener("click", () => {
        console.log("Showing debug panel");
        animationUI.options.enableDebugPanel = true;
        animationUI.createDebugPanel();
        animationUI.showDebugPanel();
      });

      document
        .getElementById("show-inspector")
        .addEventListener("click", () => {
          console.log("Showing inspector");
          animationUI.options.enableInspector = true;
          animationUI.createAnimationInspector();
          animationUI.showInspector();
        });

      document.getElementById("enable-logs").addEventListener("click", () => {
        animationManager.options.enableDebugLogs =
          !animationManager.options.enableDebugLogs;
        console.log(
          "Debug logs:",
          animationManager.options.enableDebugLogs ? "enabled" : "disabled"
        );
      });

      // Log animation manager status
      console.log("Animation manager initialized:", animationManager);
      console.log("Active animations:", animationManager.getActiveCount());
      console.log("Total animations:", animationManager.getTotalCount());
    </script>
  </body>
</html>
